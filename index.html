<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple To‑Do List</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#94a3b8; --accent:#7c3aed; --success:#16a34a;
      --glass: rgba(255,255,255,0.04);
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,#071024 0%, #071428 60%); color:#e6eef8; display:flex; align-items:center; justify-content:center; padding:32px;
    }
    .container{
      width:100%; max-width:760px; background:linear-gradient(180deg,var(--card), #07101a); border-radius:16px; padding:24px; box-shadow:0 10px 30px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }
    header{display:flex; align-items:center; justify-content:space-between; gap:12px}
    h1{margin:0; font-size:20px}
    p.lead{margin:0; color:var(--muted); font-size:13px}

    .input-row{display:flex; gap:12px; margin-top:18px}
    input[type=text]{flex:1; padding:12px 14px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:var(--glass); color:inherit; outline:none}
    input[type=text]:focus{box-shadow:0 4px 18px rgba(124,58,237,0.12); border-color:rgba(124,58,237,0.55)}
    button.add{
      padding:0 16px; border-radius:10px; border:none; background:linear-gradient(90deg,var(--accent),#5b21b6); color:white; cursor:pointer; font-weight:600
    }
    .controls{display:flex; gap:8px; margin-top:14px; align-items:center}
    .controls .filter{display:flex; gap:8px}
    .chip{padding:6px 10px; border-radius:999px; background:transparent; border:1px solid rgba(255,255,255,0.03); cursor:pointer; color:var(--muted); font-size:13px}
    .chip.active{background:rgba(124,58,237,0.12); color:var(--accent); border-color:rgba(124,58,237,0.18)}

    ul.todo-list{list-style:none; padding:0; margin:18px 0 0 0; display:block}
    li.todo{display:flex; gap:12px; align-items:center; padding:12px; border-radius:10px; margin-bottom:10px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.02)}
    .todo .title{flex:1; word-break:break-word}
    .todo .title.done{text-decoration:line-through; opacity:0.6}
    .todo .actions{display:flex; gap:8px}
    .icon-btn{background:transparent; border:none; padding:6px; border-radius:8px; cursor:pointer}
    .count{color:var(--muted); font-size:13px}

    .empty{padding:28px; text-align:center; color:var(--muted); border-radius:10px; border:1px dashed rgba(255,255,255,0.02)}

    footer{display:flex; justify-content:space-between; align-items:center; margin-top:14px}
    @media (max-width:520px){
      .container{padding:16px}
      header{flex-direction:column; align-items:flex-start; gap:8px}
      .input-row{flex-direction:column}
      button.add{width:100%}
    }
  </style>
</head>
<body>
  <div class="container" role="application" aria-labelledby="app-title">
    <header>
      <div>
        <h1 id="app-title">To‑Do List</h1>
        <p class="lead">Quick, persistent, keyboard-friendly to-do list (localStorage)</p>
      </div>
      <div class="count" id="items-count">0 items</div>
    </header>

    <div class="input-row" style="margin-top:12px">
      <input id="new-task" type="text" placeholder="Add a new task and press Enter or click Add" aria-label="New task">
      <button class="add" id="add-btn">Add</button>
    </div>

    <div class="controls">
      <div class="filter" role="tablist" aria-label="Filter tasks">
        <button class="chip active" data-filter="all">All</button>
        <button class="chip" data-filter="active">Active</button>
        <button class="chip" data-filter="completed">Completed</button>
      </div>
      <div style="margin-left:auto; display:flex; gap:8px; align-items:center">
        <button class="chip" id="clear-completed">Clear completed</button>
        <button class="chip" id="clear-all">Clear all</button>
      </div>
    </div>

    <ul class="todo-list" id="todo-list" aria-live="polite"></ul>

    <div id="empty-state" class="empty" style="display:none">No tasks yet — add something to get started ✨</div>

    <footer>
      <small class="count" id="left-count">0 left</small>
      <small class="count">Tip: press Enter to add, Shift+Enter for a newline.</small>
    </footer>
  </div>

  <script>
    // Simple to-do app with localStorage persistence
    const STORAGE_KEY = 'todo_app_tasks_v1';
    const input = document.getElementById('new-task');
    const addBtn = document.getElementById('add-btn');
    const listEl = document.getElementById('todo-list');
    const emptyState = document.getElementById('empty-state');
    const itemsCountEl = document.getElementById('items-count');
    const leftCountEl = document.getElementById('left-count');
    const filterButtons = document.querySelectorAll('.chip[data-filter]');
    let tasks = [];
    let filter = 'all';

    // load
    function load(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        tasks = raw ? JSON.parse(raw) : [];
      }catch(e){ tasks = [] }
    }
    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks)) }

    function render(){
      listEl.innerHTML = '';
      const visible = tasks.filter(t => {
        if(filter === 'all') return true;
        if(filter === 'active') return !t.done;
        return t.done;
      });

      itemsCountEl.textContent = `${tasks.length} ${tasks.length === 1 ? 'item' : 'items'}`;
      const left = tasks.filter(t => !t.done).length;
      leftCountEl.textContent = `${left} left`;

      if(visible.length === 0){
        emptyState.style.display = tasks.length === 0 ? 'block' : 'none';
      } else {
        emptyState.style.display = 'none';
      }

      visible.forEach(task => {
        const li = document.createElement('li');
        li.className = 'todo';
        li.setAttribute('data-id', task.id);

        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.checked = task.done;
        checkbox.setAttribute('aria-label', 'Mark task as done');

        checkbox.addEventListener('change', ()=>{
          task.done = checkbox.checked; save(); render();
        });

        const title = document.createElement('div');
        title.className = 'title' + (task.done ? ' done' : '');
        title.contentEditable = true;
        title.spellcheck = false;
        title.innerText = task.text;
        title.title = 'Double-click or edit text. Press Enter to finish editing.';
        title.addEventListener('keydown', (e)=>{
          if(e.key === 'Enter'){
            e.preventDefault(); title.blur();
          }
        });
        title.addEventListener('blur', ()=>{
          const text = title.innerText.trim();
          if(text === ''){
            // if emptied while editing, remove
            tasks = tasks.filter(t => t.id !== task.id);
          } else {
            task.text = text;
          }
          save(); render();
        });

        const actions = document.createElement('div');
        actions.className = 'actions';

        const editBtn = document.createElement('button');
        editBtn.className = 'icon-btn';
        editBtn.title = 'Edit';
        editBtn.innerHTML = '✏️';
        editBtn.addEventListener('click', ()=>{ title.focus(); selectAllInside(title) });

        const delBtn = document.createElement('button');
        delBtn.className = 'icon-btn';
        delBtn.title = 'Delete';
        delBtn.innerHTML = '🗑️';
        delBtn.addEventListener('click', ()=>{
          tasks = tasks.filter(t => t.id !== task.id); save(); render();
        });

        li.appendChild(checkbox);
        li.appendChild(title);
        actions.appendChild(editBtn);
        actions.appendChild(delBtn);
        li.appendChild(actions);
        listEl.appendChild(li);
      });
    }

    function selectAllInside(el){
      const range = document.createRange();
      range.selectNodeContents(el);
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
    }

    function addTask(text){
      const t = text.trim();
      if(!t) return;
      tasks.push({ id: Date.now().toString(36) + Math.random().toString(36).slice(2,6), text: t, done: false });
      save(); render();
    }

    // wire events
    addBtn.addEventListener('click', ()=>{ addTask(input.value); input.value = ''; input.focus(); });
    input.addEventListener('keydown', (e)=>{
      if(e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); addTask(input.value); input.value=''; }
    });

    document.getElementById('clear-completed').addEventListener('click', ()=>{
      tasks = tasks.filter(t => !t.done); save(); render();
    });
    document.getElementById('clear-all').addEventListener('click', ()=>{
      if(confirm('Clear ALL tasks?')){ tasks = []; save(); render(); }
    });

    filterButtons.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        filterButtons.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        filter = btn.dataset.filter; render();
      });
    });

    // initialisation
    load(); render();

    // expose for debugging in console
    window.todoApp = { tasks, save, load, render };
  </script>
</body>
</html>
